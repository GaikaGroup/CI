# Скрытие OCR текста из UI

## Изменение

OCR текст больше не отображается в интерфейсе чата, но продолжает передаваться в нейросеть.

## Причина

Отображение распознанного текста в чате загромождало интерфейс и создавало визуальный шум. Пользователь уже видит изображение, поэтому дублирование текста не нужно.

## Решение

### До изменения

```
┌─────────────────────────────┐
│ [Превью изображения]        │
└─────────────────────────────┘
Решить задачу по физике

OCR Result: Задача 20. Определите, какова цена деления...
```

### После изменения

```
┌─────────────────────────────┐
│ [Превью изображения]        │
└─────────────────────────────┘
Решить задачу по физике
```

## Техническая реализация

В `MessageList.svelte` удалены блоки отображения OCR текста:

```svelte
<!-- Удалено -->
{#if message.ocrText}
  <div class="mt-2 p-2 rounded-lg">
    <strong>OCR Result:</strong>
    {message.ocrText}
  </div>
{/if}
```

Оставлен только индикатор обработки:

```svelte
{#if isProcessingMessage(message)}
  <div class="flex items-center mt-2 text-amber-500">
    <Loader class="w-4 h-4 mr-2 animate-spin" />
    <span class="text-xs">Processing image...</span>
  </div>
{/if}
```

## Как работает OCR

1. **Пользователь загружает изображение** → Изображение отображается как превью
2. **Браузер распознает текст** → OCR работает в фоне (ClientDocumentProcessor)
3. **Текст НЕ отображается в UI** → Чистый интерфейс
4. **Текст передается в API** → `recognizedText` в request body
5. **API добавляет текст к вопросу** → `fullContent += "\n\nExercise (from photo):\n" + recognizedText`
6. **Нейросеть получает полный контекст** → Вопрос + текст с изображения
7. **Нейросеть отвечает** → Ответ учитывает текст с изображения

## Преимущества

✅ **Чистый UI** - Нет визуального шума  
✅ **Лучший UX** - Пользователь видит только изображение и свой вопрос  
✅ **Полная функциональность** - OCR продолжает работать в фоне  
✅ **Контекст сохраняется** - Нейросеть получает весь текст  

## Проверка работы

### Как убедиться, что OCR работает:

1. Загрузите изображение с задачей
2. Напишите: "Решить эту задачу"
3. Отправьте сообщение
4. Проверьте ответ нейросети

**Если нейросеть решает задачу с изображения** → OCR работает правильно ✓

### Логи в консоли:

```
[OCR] Processing images locally in the browser
[OCR] Processing image with ClientDocumentProcessor
[OCR] Image processed successfully, text length: 245
[OCR] Sending image and recognized text for message
```

### API request body:

```json
{
  "content": "Решить эту задачу",
  "images": ["data:image/png;base64,..."],
  "recognizedText": "Задача 20. Определите, какова цена деления...",
  "language": "ru"
}
```

### Что отправляется в LLM:

```
Student question:
Решить эту задачу

Exercise (from photo):
Задача 20. Определите, какова цена деления каждого из измерительных приборов...
```

## Измененные файлы

- `src/lib/modules/chat/components/MessageList.svelte` - Удалено отображение OCR текста

## Не изменялись

- `src/lib/modules/chat/services.js` - OCR продолжает работать
- `src/routes/api/chat/+server.js` - OCR текст продолжает передаваться в LLM
- Вся логика распознавания текста осталась без изменений

## Результат

Пользователь видит чистый интерфейс с превью изображения, но нейросеть получает полный контекст с распознанным текстом.
